---
import { getCollection, getEntry } from 'astro:content';
// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
  const pages = await getCollection('combos');
  return pages.map(entry => ({
    params: { slug: entry.slug }, props: { entry },
  }));
}
// 2. When it's time to render, you can get the entry directly from the prop
const { entry } = Astro.props;
const { Content } = await entry.render();
import data from '../../data.json';
let value = entry.slug

import Grid from '../../components/grid.astro';
import BaseLayout from '../../layouts/BaseLayout.astro';
let visible = false
if (entry.data.display_grid){
  visible = true
}
import Drugimage from '../../components/drugimage.astro';
import Disclaimer from '../../components/disclaimer.astro';
import ConfidencePanel from '../../components/confidence_panel.astro';
import EditPage from '../../components/edit_page.astro';
import RiskPanel from '../../components/risk_panel.astro';
import SubstanceLink from '../../components/substancelink.astro';
let [drug1, drug2] = entry.slug.split('_')
const drug1_info = await getEntry('substances', drug1);
const drug2_info = await getEntry('substances', drug2);
import { risk, confidence } from '../../util';

---
<BaseLayout pageTitle={entry.data.title}>
  <article class="prose lg:prose-xl mx-auto">
    <h2> {entry.data.title} </h2>
    <span class="grid w-full gap-2 sm:grid-cols-2">
      <Drugimage entry={drug1_info} />
      <Drugimage entry={drug2_info} />
    </span>
    <ConfidencePanel conf={confidence([drug1, drug2], data)}/>
    <RiskPanel risk={risk([drug1, drug2], data)}/>
    <Content />
    <SubstanceLink drug={drug1} />
    <SubstanceLink drug={drug2} />
    <EditPage slug={entry.slug} type={"combos"} />
  </article>
<Disclaimer />
{visible && <Grid page={entry.slug} data={data} />}
</BaseLayout>
